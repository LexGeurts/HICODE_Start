version: "3.1"

flows:
  - name: inbox_management_flow
    priority: 1
    conditions:
      - active_flow: inbox_manage
      - not:
        - active_flow: read_email
        - active_flow: draft_email
    
    steps:
      - action: utter_show_inbox
      - action: action_fetch_emails
      - slot_was_set:
          - emails: []
      - condition:
          # Check if we have emails
          - slot_was_set:
            - has_emails: true
        - action: action_display_email_list
      - condition:
          # Check if we don't have emails
          - slot_was_set:
            - has_emails: false
        - action: utter_empty_inbox
      - action: utter_email_actions

triggers:
  - flow_id: inbox_management_flow
    conditions:
      - intent: open_inbox
